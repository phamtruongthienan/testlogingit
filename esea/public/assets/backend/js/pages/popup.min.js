var app=app||{};app.init=function(){changeImage("#logoImage",'input[id="image"]',"#AdvertiseForm"),$(".select2").select2(),$("[data-mask]").inputmask(),$(document).on("shown.bs.tab",'a[data-toggle="tab"]',function(a){$.fn.dataTable.tables({visible:!0,api:!0}).columns.adjust()}),$("#modal-advertise").on("show.bs.modal",function(a){$('input[type="checkbox"]').length>0&&$('input[type="checkbox"]').iCheck({checkboxClass:"icheckbox_minimal-blue"})});var a=$(".table-dynamic-advertise").DataTable({processing:!0,serverSide:!0,ajax:base_admin+"/ajax/advertise",responsive:!0,paging:!0,lengthChange:!0,searching:!0,ordering:!0,info:!0,autoWidth:!0,scrollX:!0,scrollCollapse:!0,order:[[0,"desc"]],columns:[{data:"id"},{data:"img"},{data:"type"},{data:"position"},{data:"target"},{data:"link"},{data:"status"},{data:"action"}],columnDefs:[{width:"150px",targets:[1,2,3,4],class:"text-center"},{width:"100px",targets:[0,-2,-1],class:"text-center"}]});$("#AdvertiseForm").validator().on("submit",function(b){$("#AdvertiseBtn").button("loading"),$(".alert").addClass("no-display"),b.isDefaultPrevented()?$("#AdvertiseBtn").button("reset"):(b.preventDefault(),app.submitForm(a),$("#modal-advertise").modal("hide"),$("#AdvertiseBtn").button("reset"))}),$(document).on("click",".table-action-delete",function(b){b.preventDefault(),app.clearForm("delete"),$("#modal-advertise #id").val($(this).data("id"));$(this),$(this).parents("table").DataTable();$("#confirm-delete-modal").modal({backdrop:"static",keyboard:!1}).one("click","#confirm-delete",function(b){app.submitForm(a)})}),$(document).on("click",".table-action-edit",function(a){a.preventDefault(),app.clearForm("update");var b=$(this).data("id");$.ajax({url:base_admin+"/ajax/advertise?id="+b,type:"get",success:function(a){"200"==a.code?($("#modal-advertise #id").val(a.data.id),$("#modal-advertise #type").val(a.data.type).trigger("change"),$("#modal-advertise #content").summernote("code",a.data.mAdvertsTranslations[0].content),null!=a.data.mAdvertsTranslations[0].image&&$("#modal-advertise #logoImage").attr("src",base_url+"/img/"+a.data.mAdvertsTranslations[0].image),$("#modal-advertise #position").val(a.data.position).trigger("change"),$("#modal-advertise #target").val(a.data.target).trigger("change"),$("#modal-advertise #link").val(a.data.link),$("#modal-advertise #start_date").val(a.data.start_date),$("#modal-advertise #end_date").val(a.data.end_date),1==a.data.status?$("#modal-advertise #status").iCheck("check"):$("#modal-advertise #status").iCheck("uncheck"),$("#modal-advertise").modal("show")):$("#error-modal").modal("show")},error:function(a,b,c){$("#error_msg").html('<i class="fas fa-exclamation-triangle"></i> '+response.msg).show()}})}),$(document).on("click","#addAdvertise",function(a){a.preventDefault(),app.clearForm("insert"),$("#modal-advertise").modal("show")}),$(document).on("click","#AdvertiseBtn",function(a){a.preventDefault(),$("#AdvertiseForm").submit()}),$("#type").on("change",function(a){app.changeSelect($(this).val())})},app.changeSelect=function(a){switch(a){case"1":case"4":$("#link").prop("required",!0),$("#AdvertiseForm").validator("update"),$("#StaticImg").hide();break;case"2":$("#link").prop("required",!1),$("#AdvertiseForm").validator("validate"),$("#content").prop("required",!0),$("#AdvertiseForm").validator("update"),$("#StaticImg").hide();break;case"3":$("#StaticImg").show();break;default:$("#link, #content").prop("required",!1),$("#AdvertiseForm").validator("validate"),$("#StaticImg").hide()}},app.submitForm=function(a){$.ajax({url:base_admin+"/ajax/advertise",data:$("#AdvertiseForm").serialize(),type:"post",success:function(b){"200"==b.code?(a.ajax.reload(null,!0),$("#alert_msg_edit").removeClass("no-display"),$("#AdvertiseBtn").button("reset")):$("#error_msg").html('<i class="fas fa-exclamation-triangle"></i> '+b.msg).show()},error:function(a,b,c){$("#error_msg").html('<i class="fas fa-exclamation-triangle"></i> '+response.msg).show()}})},app.clearForm=function(a){$("#modal-advertise #action").val(a),$("#modal-advertise #id").val(""),$("#modal-advertise #type").val(1).trigger("change"),$("#modal-advertise #content").summernote("code",""),$("#modal-advertise #logoImage").attr("src",base_url+"/assets/backend/img/no_image.png"),$("#modal-advertise #image_hash").val(""),$("#modal-advertise #position").val(null).trigger("change"),$("#modal-advertise #target").val(null).trigger("change"),$("#modal-advertise #link").val(""),$("#modal-advertise #start_date").val(""),$("#modal-advertise #end_date").val(""),$("#modal-advertise #status").iCheck("uncheck")},$(function(){app.init()});
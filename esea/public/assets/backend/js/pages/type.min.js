var app=app||{};app.init=function(){$(document).on("shown.bs.tab",'a[data-toggle="tab"]',function(a){$.fn.dataTable.tables({visible:!0,api:!0}).columns.adjust()});var a=$(".table-dynamic-type").DataTable({processing:!0,serverSide:!0,ajax:base_admin+"/ajax/type",responsive:!0,paging:!0,lengthChange:!0,searching:!0,ordering:!0,info:!0,autoWidth:!0,scrollX:!0,scrollCollapse:!0,columns:[{data:"id"},{data:"name"},{data:"action"}],columnDefs:[{targets:[1],class:"text-ellipsis"},{width:"200px",targets:[-1],class:"text-center"},{width:"100px",targets:[0],class:"text-center"}]});$("#TypeForm").validator().on("submit",function(b){$("#TypeBtn").button("loading"),$(".alert").addClass("no-display"),b.isDefaultPrevented()?$("#TypeBtn").button("reset"):(b.preventDefault(),app.TypeFormSubmit(a))}),$(document).on("click",".table-action-delete",function(a){a.preventDefault();var b=$(this).data("id");$("#confirm-delete-modal #id").val(b),$("#confirm-delete-modal").modal({backdrop:"static",keyboard:!1})}),$("#confirm-delete-modal").on("click","#confirm-delete",function(b){$("#confirm-delete-modal #confirm-delete").button("loading");var c=$("#confirm-delete-modal #id").val();app.DeleteType(c,a)}),$(document).on("click",".table-action-edit, #modal-type .tab_edit_type",function(a){a.preventDefault(),$("#TypeForm #name").prop("required",!1),$("#TypeForm").validator("validate"),$("#TypeForm #name").prop("required",!0),$("#TypeForm").validator("update");var b=$(this).attr("data-id"),c=$(this).attr("data-lang");app.ClearFormType(c,"edit"),app.UpdateType(b,c)}),$(document).on("click","#addType",function(a){a.preventDefault(),$("#TypeForm")[0].reset();var b=$(this).attr("data-lang");app.ClearFormType(b,"add"),$("#modal-type .tab_edit_type").attr("data-id","null"),$("#modal-type").modal("show")}),$(document).on("click","#TypeBtn",function(a){a.preventDefault(),$("#TypeForm").submit()})},app.ClearFormType=function(a,b){"add"==b?($("#modal-type .nav-tabs").hide(),$("#modal-type #ttlModal").html("Thêm loại trường mới"),$("#modal-type #action").val("insert")):($("#modal-type .nav-tabs").show(),$("#modal-type #ttlModal").html("Cập nhật loại trường"),$("#modal-type #action").val("update")),$("#modal-type ul > li").removeClass("active"),$("#modal-type .tab_edit_type[data-lang="+a+"]").parent().addClass("active"),$("#modal-type #lang").val(a),$("#modal-type #name").val("")},app.TypeFormSubmit=function(a){$.ajax({url:base_admin+"/ajax/type",type:"post",data:$("#TypeForm").serialize(),success:function(b){"200"==b.code?(Lobibox.notify("success",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:b.msg}),a.ajax.reload(null,!0),$("#TypeBtn").button("reset"),$("#modal-type").modal("hide")):Lobibox.notify("warning",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:b.msg})},error:function(a,b,c){Lobibox.notify("warning",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:"Có lỗi trong quá trình xử lý"})}})},app.UpdateType=function(a,b){$.ajax({url:base_admin+"/ajax/type?lang="+b+"&id="+a,type:"get",success:function(a){"200"==a.code?(void 0!==a.data.mSchoolTypeTranslationsAll&&$.each(a.data.mSchoolTypeTranslationsAll,function(c,d){b==d.language_id&&($("#modal-type #id").val(a.data.id),$("#modal-type .tab_edit_type").attr("data-id",a.data.id),$("#modal-type #name").val(d.name))}),$("#modal-type").modal("show")):Lobibox.notify("warning",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:a.msg})},error:function(a,b,c){Lobibox.notify("warning",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:response.msg})}})},app.DeleteType=function(a,b){$.ajax({url:base_admin+"/ajax/type?action=delete&id="+a,type:"post",success:function(a){"200"==a.code?(Lobibox.notify("success",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:a.msg}),b.ajax.reload(null,!0)):Lobibox.notify("warning",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:a.msg}),$("#confirm-delete-modal #confirm-delete").button("reset"),$("#confirm-delete-modal").modal("hide")},error:function(a,b,c){Lobibox.notify("warning",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:"Có lỗi trong quá trình xử lý"}),$("#confirm-delete-modal #confirm-delete").button("reset"),$("#confirm-delete-modal").modal("hide")}})},$(function(){app.init()});
var app=app||{};app.init=function(){$(document).on("shown.bs.tab",'a[data-toggle="tab"]',function(a){$.fn.dataTable.tables({visible:!0,api:!0}).columns.adjust()});var a=$(".table-dynamic-language").DataTable({processing:!0,serverSide:!0,ajax:base_admin+"/ajax/language",responsive:!0,paging:!0,lengthChange:!0,searching:!0,ordering:!0,info:!0,autoWidth:!0,scrollX:!0,scrollCollapse:!0,columns:[{data:"id"},{data:"name"},{data:"action"}],columnDefs:[{targets:[1],class:"text-ellipsis"},{width:"200px",targets:[-1],orderable:!1,class:"text-center"},{width:"100px",targets:[0],class:"text-center"}]});$("#LanguageForm").validator().on("submit",function(b){$("#LanguageBtn").button("loading"),$(".alert").addClass("no-display"),b.isDefaultPrevented()?$("#LanguageBtn").button("reset"):(b.preventDefault(),app.LanguageFormSubmit(a))}),$(document).on("click",".table-action-delete",function(a){a.preventDefault();var b=$(this).data("id");$("#confirm-delete-modal #id").val(b),$("#confirm-delete-modal").modal({backdrop:"static",keyboard:!1})}),$("#confirm-delete-modal").on("click","#confirm-delete",function(b){$("#confirm-delete-modal #confirm-delete").button("loading");var c=$("#confirm-delete-modal #id").val();app.DeleteLanguage(c,a)}),$(document).on("click",".table-action-edit, #modal-language .tab_edit_language",function(a){a.preventDefault(),$("#LanguageForm #name").prop("required",!1),$("#LanguageForm").validator("validate"),$("#LanguageForm #name").prop("required",!0),$("#LanguageForm").validator("update");var b=$(this).attr("data-id"),c=$(this).attr("data-lang");app.ClearFormLanguage(c,"edit"),app.UpdateLanguage(b,c)}),$(document).on("click","#addLanguage",function(a){a.preventDefault(),$("#LanguageForm")[0].reset();var b=$(this).attr("data-lang");app.ClearFormLanguage(b,"add"),$("#modal-language .tab_edit_language").attr("data-id","null"),$("#modal-language").modal("show")}),$(document).on("click","#LanguageBtn",function(a){a.preventDefault(),$("#LanguageForm").submit()})},app.ClearFormLanguage=function(a,b){"add"==b?($("#modal-language .nav-tabs").hide(),$("#modal-language #ttlModal").html("Thêm ngoại ngữ mới"),$("#modal-language #action").val("insert")):($("#modal-language .nav-tabs").show(),$("#modal-language #ttlModal").html("Cập nhật ngoại ngữ"),$("#modal-language #action").val("update")),$("#modal-language ul > li").removeClass("active"),$("#modal-language .tab_edit_language[data-lang="+a+"]").parent().addClass("active"),$("#modal-language #lang").val(a),$("#modal-language #name").val("")},app.LanguageFormSubmit=function(a){$.ajax({url:base_admin+"/ajax/language",type:"post",data:$("#LanguageForm").serialize(),success:function(b){"200"==b.code?(Lobibox.notify("success",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:b.msg}),a.ajax.reload(null,!0),$("#LanguageBtn").button("reset"),$("#modal-language").modal("hide")):Lobibox.notify("warning",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:b.msg})},error:function(a,b,c){Lobibox.notify("warning",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:"Có lỗi trong quá trình xử lý"})}})},app.UpdateLanguage=function(a,b){$.ajax({url:base_admin+"/ajax/language?lang="+b+"&id="+a,type:"get",success:function(a){"200"==a.code?(void 0!==a.data.mSchoolLanguageTranslationsAll&&$.each(a.data.mSchoolLanguageTranslationsAll,function(c,d){b==d.language_id&&($("#modal-language #id").val(a.data.id),$("#modal-language .tab_edit_language").attr("data-id",a.data.id),$("#modal-language #name").val(d.name))}),$("#modal-language").modal("show")):Lobibox.notify("warning",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:a.msg})},error:function(a,b,c){Lobibox.notify("warning",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:response.msg})}})},app.DeleteLanguage=function(a,b){$.ajax({url:base_admin+"/ajax/language?action=delete&id="+a,type:"post",success:function(a){"200"==a.code?(Lobibox.notify("success",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:a.msg}),b.ajax.reload(null,!0)):Lobibox.notify("warning",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:a.msg}),$("#confirm-delete-modal #confirm-delete").button("reset"),$("#confirm-delete-modal").modal("hide")},error:function(a,b,c){Lobibox.notify("warning",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:"Có lỗi trong quá trình xử lý"}),$("#confirm-delete-modal #confirm-delete").button("reset"),$("#confirm-delete-modal").modal("hide")}})},$(function(){app.init()});
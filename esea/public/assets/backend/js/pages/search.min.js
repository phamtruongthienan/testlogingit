var app=app||{};app.init=function(){function a(a){var b=(a.data("id"),a.data("id2"),a.parents("tr"));$.ajax({success:function(a){c(b,"up")},error:function(a,b,c){$("#error_msg").html('<i class="fas fa-exclamation-triangle"></i> '+response.msg).show()}})}function b(a){var b=(a.data("id"),a.data("id2"),a.parents("tr"));$.ajax({success:function(a){c(b,"down")},error:function(a,b,c){$("#error_msg").html('<i class="fas fa-exclamation-triangle"></i> '+response.msg).show()}})}function c(a,b){var c=d.row(a).index(),e=-1;"down"===b&&(e=1);var f=d.row(c).data();f.sort+=e;var g=d.row(c+e).data();g.sort+=-e,d.row(c).data(g),d.row(c+e).data(f),d.draw(!1)}$.fn.validator.Constructor.INPUT_SELECTOR=':input:not([type="hidden"], [type="submit"], [type="reset"], button, .select2-search__field)',$("#tagKey, #tagEditKey").select2({data:["Internatinal","Binglingual"],tags:!0,tokenSeparators:[","," "],placeholder:{id:"",text:"Từ khóa"}}),$(".single-select2").select2({placeholder:"Chọn"}),$("#tagKey").on("change",function(){$(this).trigger("blur"),console.log("aa")}),$(".modal").on("show.bs.modal",function(a){$('input[type="radio"], input[type="checkbox"]').length>0&&$('input[type="radio"], input[type="checkbox"]').iCheck({checkboxClass:"icheckbox_minimal-blue",radioClass:"iradio_minimal-blue"})}),$("#modal-search-add").on("hidden.bs.modal",function(a){$("#addSearchForm")[0].reset(),$(".single-select2, #tagKey, #tagEditKey").trigger("change.select2"),$("#tagKey, #tagEditKey").val([])});var d;$(".table-dynamic-search").DataTable({processing:!0,ajax:"/data/search.json",responsive:!0,paging:!0,lengthChange:!0,searching:!0,ordering:!0,info:!0,autoWidth:!0,scrollX:!0,scrollCollapse:!0,ordering:!1,columns:[{data:"id"},{data:"keyword"},{data:null}],columnDefs:[{targets:[1],class:"text-ellipsis"},{width:"200px",targets:[-1],class:"text-center"},{width:"100px",targets:[0],class:"text-center"},{targets:[-1],render:function(a,b,c,d){return'<a class="table-action table-action-edit text-green cursor-pointer" data-id="'+a.id+'"><i class="fa fa-edit"></i></a> <a class="table-action text-red table-action-delete cursor-pointer" data-id="'+a.id+'"><i class="fa fa-trash"></i></a>'}}]}),$(".table-dynamic-typePriority").DataTable({processing:!0,ajax:"/data/search.json",responsive:!0,paging:!0,lengthChange:!0,searching:!0,ordering:!0,info:!0,autoWidth:!0,scrollX:!0,scrollCollapse:!0,ordering:!1,columns:[{data:"id"},{data:"type"},{data:"name"},{data:"active"},{data:null}],columnDefs:[{targets:[1],class:"text-ellipsis"},{width:"150px",targets:[-1],class:"text-center"},{width:"200px",targets:[2],class:"text-center"},{width:"100px",targets:[0,-2],class:"text-center"},{targets:[-1],render:function(a,b,c,d){return'<a class="table-action table-action-edit text-green cursor-pointer" data-id="'+a.id+'"><i class="fa fa-edit"></i></a> <a class="table-action text-red table-action-delete cursor-pointer" data-id="'+a.id+'"><i class="fa fa-trash"></i></a>'}},{targets:[-2],render:function(a,b,c,d){return 1==a?'<i class="fas fa-check-circle text-green"></i>':""}}]});$('a[href="#tab_list_school"], a[href="#tab_list_school_edit"]').on("shown.bs.tab",function(c){$.fn.DataTable.isDataTable(".table-dynamic-listSchool")&&$(".table-dynamic-listSchool").DataTable().destroy();var e=$($(this).attr("href")).find(".table-dynamic-listSchool");d=e.DataTable({processing:!0,ajax:"/data/search.json",responsive:!0,paging:!0,lengthChange:!0,searching:!0,ordering:!0,info:!0,autoWidth:!0,scrollX:!0,scrollCollapse:!0,ordering:!1,columns:[{data:"id"},{data:"school"},{data:"sort"},{data:"active"},{data:null},{data:null}],columnDefs:[{targets:[1],class:"text-ellipsis"},{width:"150px",targets:[-1,-2],class:"text-center"},{width:"100px",targets:[0,-3,2],class:"text-center"},{targets:[-1],render:function(a,b,c,d){return'<a class="table-action table-action-edit text-green cursor-pointer" data-id="'+a.id+'"><i class="fa fa-edit"></i></a> <a class="table-action text-red table-action-delete cursor-pointer" data-id="'+a.id+'"><i class="fa fa-trash"></i></a>'}},{targets:[-3],render:function(a,b,c,d){return 1==a?'<i class="fas fa-check-circle text-green"></i>':""}},{targets:-2,render:function(a,b,c,d){if("display"===b){var e=$("<span></span>");return d.row>0&&$('<a data-id="'+a.id+'" data-id2="'+(a.sort-1)+'" class="upBtn table-action text-primary cursor-pointer"><i class="fas fa-caret-square-up"></i></a>').appendTo(e),$('<a data-id="'+a.id+'" data-id2="'+(a.sort+1)+'" class="downBtn table-action text-primary cursor-pointer"><i class="fas fa-caret-square-down"></i></a>').appendTo(e),e.html()}return a}}],drawCallback:function(){var c=$(this);c.find("tr:last .downBtn").remove(),c.find(".upBtn").unbind("click"),c.find(".downBtn").unbind("click"),c.find(".upBtn").on("click",function(){a($(this))}),c.find(".downBtn").on("click",function(){b($(this))})}})}),$(".modal").on("shown.bs.modal",function(a){$.fn.dataTable.tables({visible:!0,api:!0}).columns.adjust()}),$(document).on("shown.bs.tab",'a[data-toggle="tab"]',function(a){$.fn.dataTable.tables({visible:!0,api:!0}).columns.adjust()}),$("#addSearchForm").validator().on("submit",function(a){$("#addSearchBtn").button("loading"),$(".alert").addClass("no-display"),a.isDefaultPrevented()?$("#addSearchBtn").button("reset"):(a.preventDefault(),setTimeout(function(){$("#alert_msg").removeClass("no-display"),$("#addSearchBtn").button("reset"),setTimeout(function(){$(".alert").addClass("no-display")},3e3),$("#modal-search-add").modal("hide")},1e3))}),$("#editSearchForm").validator().on("submit",function(a){$("#editSearchBtn").button("loading"),$(".alert").addClass("no-display"),a.isDefaultPrevented()?$("#editSearchBtn").button("reset"):(a.preventDefault(),setTimeout(function(){$("#alert_msg_edit").removeClass("no-display"),$("#editSearchBtn").button("reset"),setTimeout(function(){$(".alert").addClass("no-display")},3e3)},1e3))}),$(document).on("click",".table-action-delete",function(a){a.preventDefault();var b=$(this),c=$(this).parents("table").DataTable();$("#confirm-delete-modal").modal({backdrop:"static",keyboard:!1}).one("click","#confirm-delete",function(a){c.row(b.parents("tr")).remove().draw()})}),$(document).on("click",".table-dynamic-search .table-action-edit",function(a){a.preventDefault();$(this).data("id");$("#modal-search-edit").modal("show")}),$(document).on("click",".table-dynamic-typePriority .table-action-edit",function(a){a.preventDefault();$(this).data("id");$("#modal-typePriority-edit").modal("show")}),$(document).on("click",".table-dynamic-listSchool .table-action-edit",function(a){a.preventDefault();$(this).data("id");$("#modal-school-edit").modal("show")}),$(document).on("click","#addSearch",function(a){a.preventDefault(),$("#modal-search-add").modal("show")}),$(document).on("click",".addTypePriority",function(a){a.preventDefault(),$("#modal-typePriority-add").modal("show")}),$(document).on("click",".btnAddSchool",function(a){a.preventDefault(),$("#modal-school-add").modal("show")}),$(document).on("click","#addSearchBtn",function(a){a.preventDefault(),$("#addSearchForm").submit()}),$(document).on("click","#editSearchBtn",function(a){a.preventDefault(),$("#editSearchForm").submit()})},$(function(){app.init()});
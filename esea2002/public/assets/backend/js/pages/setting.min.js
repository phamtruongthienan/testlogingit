var app=app||{};app.init=function(){changeImage("#logoImage",'input[id="logoFile"]',"#infoForm"),$('input[type="checkbox"].minimal').iCheck({checkboxClass:"icheckbox_minimal-blue",radioClass:"iradio_minimal-blue"}),$("[data-mask]").inputmask(),$(".my-colorpicker").colorpicker(),$(document).on("shown.bs.tab",'a[href="#language"]',function(a){$.fn.dataTable.tables({visible:!0,api:!0}).columns.adjust()}),$(document).on("shown.bs.tab",'a[href="#information"], a[href="#seo"]',function(a){$("#blockLanguage").show()}),$(document).on("shown.bs.tab",'a[href="#social"], a[href="#language"]',function(a){$("#blockLanguage").hide()});var a=$(".table-dynamic-language").DataTable({processing:!0,serverSide:!0,ajax:base_admin+"/ajax/setting",responsive:!0,paging:!0,lengthChange:!0,searching:!0,ordering:!0,info:!0,autoWidth:!0,scrollX:!0,scrollCollapse:!0,columns:[{data:"id"},{data:"name"},{data:"code"},{data:"default"},{data:"currency_code"},{data:"date_format"},{data:"action"}],columnDefs:[{width:"150px",targets:[3,4,5],class:"text-center"},{width:"100px",targets:[0,2],class:"text-center"},{width:"200px",targets:[-1],orderable:!1,class:"text-center"},{targets:[3],orderable:!1}],drawCallback:function(a){$('input[type="radio"]').length>0&&$('input[type="radio"]').iCheck({radioClass:"iradio_minimal-blue"})}});$(a.table().container()).on("ifChecked",'input[type="radio"]',function(){var b=$(this).data("id");$.ajax({url:base_admin+"/ajax/setting?action=update&type=2&id="+b,type:"post",success:function(b){"200"==b.code?(Lobibox.notify("success",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:b.msg}),a.ajax.reload(null,!0)):Lobibox.notify("warning",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:b.msg})},error:function(a,b,c){Lobibox.notify("warning",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:"Có lỗi trong quá trình xử lý"})}})}),$("#infoForm").validator().on("submit",function(a){$("#InfoBtn").button("loading"),$(".alert").addClass("no-display"),a.isDefaultPrevented()?$("#InfoBtn").button("reset"):(a.preventDefault(),app.SettingFormSubmit("#infoForm","","#InfoBtn",""))}),app.UpdateConfigMain(),app.UpdateConfigOther(),$("#seoForm").validator().on("submit",function(a){$("#SeoBtn").button("loading"),$(".alert").addClass("no-display"),a.isDefaultPrevented()?$("#SeoBtn").button("reset"):(a.preventDefault(),app.SettingFormSubmit("#seoForm","","#SeoBtn",""))}),$("#socialForm").validator().on("submit",function(a){$("#addSocialBtn").button("loading"),$(".alert").addClass("no-display"),a.isDefaultPrevented()?$("#addSocialBtn").button("reset"):(a.preventDefault(),app.SettingFormSubmit("#socialForm","","#addSocialBtn",""))}),$("#editLanguageForm").validator().on("submit",function(b){$("#editLanguageBtn").button("loading"),$(".alert").addClass("no-display"),b.isDefaultPrevented()?$("#editLanguageBtn").button("reset"):(b.preventDefault(),app.SettingFormSubmit("#editLanguageForm",a,"#editLanguageBtn","#modal-language-edit"))}),$(document).on("click",".table-action-edit",function(a){a.preventDefault();var b=$(this).data("id");app.UpdateConfigLanguage(b),$("#modal-language-edit").modal("show")}),$(document).on("click","#editLanguageBtn",function(a){a.preventDefault(),$("#editLanguageForm").submit()})},app.UpdateConfigMain=function(){$.ajax({url:base_admin+"/ajax/setting?table=main",type:"get",success:function(a){"200"==a.code?void 0!==a.data.configMainTranslations&&$.each(a.data.configMainTranslations,function(b,c){null!=c.logo?$("#infoForm #logoImage").attr("src",base_url+"/img/"+c.logo):$("#infoForm #logoImage").attr("src",base_url+"/assets/backend/img/avatar.png"),$("#infoForm .id").val(a.data.id),$("#seoForm .id").val(a.data.id),$("#infoForm #name").val(c.name),$("#infoForm #company_name").val(c.company_name),$("#infoForm #slogan").val(c.slogan),$("#infoForm #quote").val(c.quote),$("#infoForm #address").val(c.address),$("#infoForm #phone").val(c.phone),$("#infoForm #email").val(c.email),$("#infoForm #represent").val(c.represent),$("#infoForm #num_promo").val(c.num_promo),c.enable_ssl?$("#seoForm #enable_ssl").iCheck("check"):$("#seoForm #enable_ssl").iCheck("uncheck"),$("#seoForm #meta_title").val(c.meta_title),$("#seoForm #meta_keyword").val(c.meta_keyword),$("#seoForm #meta_description").val(c.meta_description),$("#seoForm #analytics_id").val(c.analytics_id),$("#seoForm #facebook_page").val(c.facebook_page),$("#seoForm #googleplus_page").val(c.googleplus_page);var d=c.background_search.split(","),e=$("#infoForm .background_search.my-colorpicker");$.each(d,function(a,b){$(e[a]).colorpicker("setValue",b)});var f=c.background_promotion.split(","),g=$("#infoForm .background_promotion.my-colorpicker");$.each(f,function(a,b){$(g[a]).colorpicker("setValue",b)});var h=c.background_client.split(","),i=$("#infoForm .background_client.my-colorpicker");$.each(h,function(a,b){$(i[a]).colorpicker("setValue",b)})}):Lobibox.notify("warning",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:a.msg})},error:function(a,b,c){Lobibox.notify("warning",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:response.msg})}})},app.UpdateConfigOther=function(){$.ajax({url:base_admin+"/ajax/setting?table=other",type:"get",success:function(a){"200"==a.code?$.each(a.data,function(a,b){switch(b.key){case"FB_APP_ID":$("#socialForm #FB_APP_ID").val(b.value);break;case"FB_APP_KEY":$("#socialForm #FB_APP_KEY").val(b.value);break;case"FB_APP_CALLBACK":$("#socialForm #FB_APP_CALLBACK").val(b.value);break;case"GG_APP_ID":$("#socialForm #GG_APP_ID").val(b.value);break;case"GG_APP_KEY":$("#socialForm #GG_APP_KEY").val(b.value);break;case"GG_APP_CALLBACK":$("#socialForm #GG_APP_CALLBACK").val(b.value);break;default:$("#socialForm #GG_KEY_MAP").val(b.value)}}):Lobibox.notify("warning",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:a.msg})},error:function(a,b,c){Lobibox.notify("warning",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:response.msg})}})},app.UpdateConfigLanguage=function(a){$.ajax({url:base_admin+"/ajax/setting?id="+a,type:"get",success:function(a){"200"==a.code?($("#editLanguageForm .id").val(a.data.id),$("#editLanguageForm #name").val(a.data.name),$("#editLanguageForm #code").text(a.data.code),$("#editLanguageForm #currency_code").val(a.data.currency_code),a.data.mExchangeRate.length>0?$("#editLanguageForm #rate").val(a.data.mExchangeRate[0].rate):$("#editLanguageForm #rate").val(""),$("#editLanguageForm #date_format").val(a.data.date_format).trigger("change")):Lobibox.notify("warning",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:a.msg})},error:function(a,b,c){Lobibox.notify("warning",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:response.msg})}})},app.SettingFormSubmit=function(a,b,c,d){$.ajax({url:base_admin+"/ajax/setting",type:"post",data:$(a).serialize(),success:function(a){"200"==a.code?(Lobibox.notify("success",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:a.msg}),""!=b&&b.ajax.reload(null,!0),$(c).button("reset"),""!=d&&$(d).modal("hide")):Lobibox.notify("warning",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:a.msg})},error:function(a,b,c){Lobibox.notify("warning",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:"Có lỗi trong quá trình xử lý"})}})},$(function(){app.init()});